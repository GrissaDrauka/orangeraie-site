<!-- Overlay sombre -->
<div *ngIf="isOpen" class="fixed inset-0 bg-black/30 backdrop-blur-sm z-40 md:hidden" (click)="closeMenu()"></div>

<!-- Navbar principale -->
<header [ngClass]="{
  'bg-[#f9f4ef]/80 backdrop-blur-md shadow-md scale-95 border-b border-orangeraie py-2': isScrolled,
  'bg-[#f9f4ef] scale-100 border-transparent py-4': !isScrolled
}" class="fixed top-0 left-0 w-full z-50 transition-all duration-300 border-b">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center h-16">
        <!-- Logo -->
        <a routerLink="/" class="flex items-center space-x-2 text-orangeraie font-serif font-bold text-xl">
            <img src="assets/logo_orangeraie_petit.png" alt="Logo" class="h-26 w-20" />
            <span>L'Orangeraie</span>
        </a>

        <!-- Bouton burger mobile -->
        <button class="md:hidden text-orangeraie text-3xl" (click)="toggleMenu()">
            <span *ngIf="!isOpen">☰</span>
            <span *ngIf="isOpen">✕</span>
        </button>

        <!-- Menu desktop -->
        <nav class="hidden md:flex space-x-6 text-sm font-semibold tracking-wide">
            <a routerLink="/" routerLinkActive="text-orangeraie" [routerLinkActiveOptions]="{ exact: true }"
                class="hover:text-orangeraie relative transition-all duration-300 after:content-[''] after:absolute after:left-0 after:-bottom-1 after:w-0 after:h-[2px] after:bg-orangeraie after:transition-all after:duration-300 hover:after:w-full">
                {{ 'navbar.home' | translate }}
            </a>
            <!-- Menu déroulant Nos Hébergements -->
            <div class="relative group">
                <!-- Bouton déclencheur -->
                <button
                    class="hover:text-orangeraie relative transition-all duration-300 font-semibold text-sm tracking-wide flex items-center gap-1">
                    {{ 'navbar.accommodation' | translate }}
                    <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </button>

                <!-- Menu déroulant -->
                <div
                    class="absolute top-full left-0 bg-white border border-orange-100 rounded-lg shadow z-50 opacity-0 group-hover:opacity-100 group-hover:pointer-events-auto pointer-events-none transition-all duration-300 w-full">
                    <a routerLink="/chambres" routerLinkActive="text-orangeraie"
                        [routerLinkActiveOptions]="{ exact: true }"
                        class="block px-4 py-2 text-sm text-gray-700 hover:bg-orange-50 transition">
                        {{ 'navbar.rooms' | translate }}
                    </a>
                    <a routerLink="/gite" routerLinkActive="text-orangeraie" [routerLinkActiveOptions]="{ exact: true }"
                        class="block px-4 py-2 text-sm text-gray-700 hover:bg-orange-50 transition">
                        {{ 'navbar.gite' | translate }}
                    </a>
                </div>
            </div>
            <a routerLink="/reservation" routerLinkActive="text-orangeraie" [routerLinkActiveOptions]="{ exact: true }"
                class="hover:text-orangeraie relative transition-all duration-300 after:content-[''] after:absolute after:left-0 after:-bottom-1 after:w-0 after:h-[2px] after:bg-orangeraie after:transition-all after:duration-300 hover:after:w-full">
                {{ 'navbar.reservation' | translate }}
            </a>
            <a routerLink="/infos-pratiques" routerLinkActive="text-orangeraie"
                [routerLinkActiveOptions]="{ exact: true }"
                class="hover:text-orangeraie relative transition-all duration-300 after:content-[''] after:absolute after:left-0 after:-bottom-1 after:w-0 after:h-[2px] after:bg-orangeraie after:transition-all after:duration-300 hover:after:w-full">
                {{ 'navbar.infos' | translate }}
            </a>
            <a routerLink="/activites" routerLinkActive="text-orangeraie" [routerLinkActiveOptions]="{ exact: true }"
                class="hover:text-orangeraie relative transition-all duration-300 after:content-[''] after:absolute after:left-0 after:-bottom-1 after:w-0 after:h-[2px] after:bg-orangeraie after:transition-all after:duration-300 hover:after:w-full">
                {{ 'navbar.activities' | translate }}
            </a>
            <div class="flex items-center gap-2">
                <img src="assets/i18n/Flag_of_France.svg" alt="Français" class="h-4 max-w-[1.5rem] cursor-pointer"
                    [ngClass]="{ 'ring-2 ring-orange-500 rounded': currentLang === 'fr' }" (click)="switchLang('fr')" />
                <img src="assets/i18n/Flag_UK.svg" alt="English" class="h-4 max-w-[1.5rem] cursor-pointer"
                    [ngClass]="{ 'ring-2 ring-orange-500 rounded': currentLang === 'en' }" (click)="switchLang('en')" />
            </div>
        </nav>
    </div>
</header>

<!-- Menu mobile animé -->
<div *ngIf="true" [ngClass]="{
  'scale-y-100 opacity-100': isOpen,
  'scale-y-0 opacity-0 pointer-events-none': !isOpen
}"
    class="fixed top-[5.5rem] left-0 w-full z-50 origin-top transition-all duration-300 transform bg-[#f9f4ef]/95 backdrop-blur-md shadow-xl px-4 pb-4 md:hidden">
    <nav class="flex flex-col space-y-3 text-sm font-semibold text-orangeraie tracking-wide mt-2">
        <!-- Drapeaux langue (mobile only) -->
        <div class="flex md:hidden items-center gap-2 ml-2">
            <img src="assets/i18n/Flag_of_France.svg" alt="Français" class="h-5 max-w-[1.7rem] cursor-pointer"
                [ngClass]="{ 'ring-2 ring-orange-500 rounded': currentLang === 'fr' }" (click)="switchLang('fr')" />
            <img src="assets/i18n/Flag_UK.svg" alt="English" class="h-5 max-w-[1.7rem] cursor-pointer"
                [ngClass]="{ 'ring-2 ring-orange-500 rounded': currentLang === 'en' }" (click)="switchLang('en')" />
        </div>
        <a routerLink="/" (click)="closeMenu()"
            class="hover:text-[#7a583f] pl-3 border-l-4 border-transparent hover:border-orangeraie transition-all duration-300">
            {{ 'navbar.home' | translate }}
        </a>
        <!-- Bouton cliquable pour ouvrir/cacher les sous-liens -->
        <button (click)="isHebergementsOpen = !isHebergementsOpen"
            class="flex justify-between items-center pl-3 pr-4 py-2 w-full font-bold text-orangeraie hover:text-[#7a583f] border-l-4 border-transparent hover:border-orangeraie transition">
            {{ 'navbar.accommodation' | translate }}
            <svg class="w-4 h-4 transform transition-transform duration-300"
                [ngClass]="{ 'rotate-180': isHebergementsOpen }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </button>

        <!-- Sous-menu affiché uniquement si ouvert -->
        <div *ngIf="isHebergementsOpen" class="pl-6 flex flex-col space-y-1">
            <a routerLink="/chambres" (click)="closeHebergementsMenu()"
                class="border-l-4 border-transparent hover:border-orangeraie hover:text-[#7a583f] transition pl-3 py-1">
                {{ 'navbar.rooms' | translate }}
            </a>
            <a routerLink="/gite" (click)="closeHebergementsMenu()"
                class="border-l-4 border-transparent hover:border-orangeraie hover:text-[#7a583f] transition pl-3 py-1">
                {{ 'navbar.gite' | translate }}
            </a>
        </div>
        <a routerLink="/reservation" (click)="closeMenu()"
            class="hover:text-[#7a583f] pl-3 border-l-4 border-transparent hover:border-orangeraie transition-all duration-300">
            {{ 'navbar.reservation' | translate }}
        </a>
        <a routerLink="/infos-pratiques" (click)="closeMenu()"
            class="hover:text-[#7a583f] pl-3 border-l-4 border-transparent hover:border-orangeraie transition-all duration-300">
            {{ 'navbar.infos' | translate }}
        </a>
        <a routerLink="/activites" (click)="closeMenu()"
            class="hover:text-[#7a583f] pl-3 border-l-4 border-transparent hover:border-orangeraie transition-all duration-300">
            {{ 'navbar.activities' | translate }}
        </a>
    </nav>
</div>